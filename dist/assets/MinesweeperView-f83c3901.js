import{u as A,h as D,M as H,g as J,a as Q}from"./getClickEarn-9987c80d.js";import{d as G,u as U,a as k,r as B,w as W,o as P,b as r,c as p,e as X,v as Z,f as s,n as E,t as f,g as C,F as R,h as Y,i as a,_ as T,j as S,k as V,I as v,p as M,l as ee,m as te,q as I,s as ae,x as j,A as oe}from"./index-95e07d1d.js";const se={class:"controls"},ne={key:0,class:"error"},ie={class:"number-container"},ce=["onClick"],le=["disabled"],re=G({__name:"MinesweeperControl",setup(h){const _=A(),e=U(),{post:m,data:b}=k("/api/create-game"),n=B();W(b,(t,o)=>{t.gameid&&_.getGame(t.gameid)});function g(t){!"1234567890".split("").includes(t.key)&&t.key!=="Backspace"&&t.preventDefault()}const u=B(void 0);function c(){if(!n.value){u.value="must have a value";return}if(!e.balance){u.value="you have no funds";return}if(n.value<=0){u.value="enter a value over 0";return}if(n.value>e.balance){u.value="not enough cash";return}u.value=void 0,m({bombCount:l[i.value],stake:n.value}).then(t=>{k("/api/balance").post({gameid:t.gameid,balance:-n.value}).then(y=>{e.balance=y.balance})})}const l=[1,3,5,24],i=B(0);P(()=>{const t=localStorage.getItem("multiplier");t&&(i.value=parseInt(t))});function d(t){localStorage.setItem("multiplier",`${t}`),i.value=t}return(t,o)=>{var y;return r(),p("div",se,[X(s("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=$=>n.value=$),onKeydown:g,placeholder:"Bet amount..",class:E(["bet-input",{inputError:u.value}])},null,34),[[Z,n.value,void 0,{number:!0}]]),u.value?(r(),p("p",ne,f(u.value),1)):C("",!0),s("div",ie,[(r(),p(R,null,Y(l,($,w)=>s("div",{key:w,onClick:q=>d(w),class:E({active:i.value===w})},f($),11,ce)),64))]),s("button",{class:"button",disabled:((y=a(_).game)==null?void 0:y.state)==="ongoing",onClick:c}," create game ",8,le)])}}});const ue=T(re,[["__scopeId","data-v-47012af0"]]),me={class:"informatics"},pe={class:"information-container",title:"Stake in game"},_e={class:"svg-container"},de={class:"information-container",title:"Bomb Count"},ge={class:"svg-container"},ve={class:"information-container",title:"Earn per click"},be={class:"svg-container"},fe=G({__name:"MinesweeperInfomatics",setup(h){const _=A();return(e,m)=>{var b,n,g;return r(),p("div",me,[s("div",pe,[s("div",_e,[(r(),S(V(a(v).coin),{mainFill:"var(--color-text-subtle)",secondaryFill:"var(--color-container-titles)"}))]),s("p",null,f(a(M)((b=a(_).game)==null?void 0:b.stake)),1)]),s("div",de,[s("div",ge,[(r(),S(V(a(v).minesweeper),{fill:"var(--color-text-subtle)"}))]),s("p",null,f(((n=a(_).game)==null?void 0:n.bomb.count)||0),1)]),s("div",ve,[s("div",be,[(r(),S(V(a(v).mouseclick),{fill:"var(--color-text-subtle)"}))]),s("p",null,f(a(M)((g=a(_).game)==null?void 0:g.nextClick)),1)])])}}});const he=T(fe,[["__scopeId","data-v-22b9a101"]]),ye=h=>(ee("data-v-84787296"),h=h(),te(),h),ke={key:0,class:"tooltip"},$e=ye(()=>s("span",null,"copied",-1)),we=[$e],Ce=G({__name:"AppCopyGameOutput",setup(h){const _=U(),e=A(),m=B(!1);function b(){var u,c,l,i,d,t;if(((u=e.game)==null?void 0:u.state)!=="done")return;let n=`${_.username} has ${((c=e.game)==null?void 0:c.result)==="lost"?"lost":"claimed"}: $${M((l=e.game)==null?void 0:l.pool)}
`,g=((i=e.game)==null?void 0:i.result)==="lost"?v.copy.bomb.lost:v.copy.bomb.won;for(let o=1;o<=((d=e.game)==null?void 0:d.size);o++)n+=(t=e.game)!=null&&t.bomb.position.includes(o)?g:D(o,e.game.clicks)?v.copy.click:v.copy.default,o%5===0&&(n+=`
`);n+=`
Visit https://daqy.dev/minesweeper to play`,navigator.clipboard.writeText(n),m.value=!0,setTimeout(()=>{m.value=!1},1e3)}return(n,g)=>(r(),p("span",{onClick:b},[(r(),S(V(m.value?a(v).copy.copied:a(v).copy.icon),{class:E({copied:m.value})},null,8,["class"])),m.value?(r(),p("span",ke,we)):C("",!0)]))}});const K=T(Ce,[["__scopeId","data-v-84787296"]]),Se={class:"game-container"},Me={class:"big-container"},xe={class:"control-container"},Ie={class:"control-space"},Be={class:"infomatics-container"},Ve={class:"claim-container"},Ae=["disabled"],Ge={key:1,style:{color:"var(--color-create-game-button)"}},Te={key:2,style:{color:"var(--color-bomb-background)"}},qe=G({__name:"MinesweeperView",setup(h){const _=U(),e=A(),m=B(!1);P(()=>{console.log(e.game),e.game||e.getLatestGame()});function b(c,l=c){return Math.pow(1/c*l,.5)*100}function n(c){return new Promise(l=>{setTimeout(l,c)})}function g(c){if(D(c,e.game.clicks)||e.game.state==="done"||m.value)return;const{get:l}=k(`/api/game/${e.game._id}/click?clickPosition=${c}`);l().then(i=>{if(i)if(i.state==="done"){e.game={...e.game,...i};const{get:d}=k(`/api/game/${e.game._id}/bomb-locations`);d().then(async t=>{if(e.game.bomb.position=[],i.result==="lost"){e.game.bomb.position.push(c);for(let o=t.length-1;o>=0;o--)c!==t[o]&&(await n(b(t.length,o)),e.game.bomb.position.push(t[o]))}else e.game.bomb.position=t})}else e.game={...e.game,...i};m.value=!1})}function u(){const{post:c}=k("/api/claim-game");c({gameid:e.game._id}).then(l=>{e.game={...e.game,...l};const{get:i}=k(`/api/game/${l._id}/bomb-locations`);i().then(t=>{e.game.bomb.position=t}),k("/api/balance").post({gameid:l._id,balance:l.pool}).then(t=>{_.balance=t.balance})})}return(c,l)=>{var i,d,t,o,y,$,w,q,F;return r(),p("main",null,[s("section",Se,[s("div",Me,[I(H,{loading:a(e).loading},{default:ae(()=>{var z;return[(r(!0),p(R,null,Y((z=a(e).game)==null?void 0:z.size,x=>{var L,N,O;return r(),S(Q,{key:x,id:x,isBomb:(O=(N=(L=a(e).game)==null?void 0:L.bomb)==null?void 0:N.position)==null?void 0:O.includes(x),flip:a(D)(x,a(e).game.clicks),earn:a(J)(x,a(e).game),onSquareClick:g},null,8,["id","isBomb","flip","earn"])}),128))]}),_:1},8,["loading"])])]),s("section",xe,[s("div",Ie,[I(ue),s("div",Be,[I(he),s("div",Ve,[((i=a(e).game)==null?void 0:i.state)==="ongoing"?(r(),p("button",{key:0,onClick:u,disabled:((d=a(e).game)==null?void 0:d.clicks.length)===0}," claim $"+f(a(M)((t=a(e).game)==null?void 0:t.pool)),9,Ae)):C("",!0),((o=a(e).game)==null?void 0:o.state)==="done"&&((y=a(e).game)==null?void 0:y.result)==="claimed"?(r(),p("p",Ge,[j(" Claimed: $"+f(a(M)(($=a(e).game)==null?void 0:$.pool))+" ",1),I(K)])):C("",!0),((w=a(e).game)==null?void 0:w.state)==="done"&&((q=a(e).game)==null?void 0:q.result)==="lost"?(r(),p("p",Te,[j(" You lost a pontential: $"+f(a(M)((F=a(e).game)==null?void 0:F.pool))+" ",1),I(K)])):C("",!0),a(e).game?C("",!0):(r(),S(oe,{key:3,height:"100%"}))])])])])])}}});const Ue=T(qe,[["__scopeId","data-v-b7eaacf7"]]);export{Ue as default};
